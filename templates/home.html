<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Trang ch·ªß</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="container">
        <h2>Ch√†o, {{ username }}!</h2>
        <p>üíé Kim c∆∞∆°ng: <strong>{{ diamonds }}</strong></p>

        <div class="card recharge-form">
            <h3>üïπÔ∏è N·∫°p th·∫ª game</h3>
            <form method="POST" action="/recharge">
                <select name="card_type" required>
                    <option value="">--Ch·ªçn lo·∫°i th·∫ª--</option>
                    <option value="viettel">Viettel</option>
                    <option value="mobifone">Mobifone</option>
                    <option value="vinaphone">Vinaphone</option>
                </select>

                <select name="amount" required>
                    <option value="">--Ch·ªçn m·ªánh gi√°--</option>
                    <option value="10000">10.000 VNƒê 95kc</option>
                    <option value="20000">20.000 VNƒê 185kc</option>
                    <option value="50000">50.000 VNƒê 215kc</option>
                    <option value="100000">100.000 VNƒê 1.745kc</option>
                    <option value="200000">200.000 VNƒê 3.900kc</option>
                </select>

                <input type="text" name="serial" placeholder="S·ªë serial" required>
                <input type="text" name="code" placeholder="M√£ th·∫ª" required>
                <button type="submit">N·∫°p ngay</button>
            </form>
        </div>

        <div class="card recharge-box">
            <h3>üíé N·∫°p kim c∆∞∆°ng</h3>
            <form id="recharge-form">
                <input type="text" id="game-id" placeholder="Nh·∫≠p ID game" required>
                <select id="diamond-amount" required>
                    <option value="" disabled selected>Ch·ªçn s·ªë kim c∆∞∆°ng</option>
                    <option value="100">100 kim c∆∞∆°ng</option>
                    <option value="200">200 kim c∆∞∆°ng</option>
                    <option value="500">500 kim c∆∞∆°ng</option>
                </select>
                <button type="submit">N·∫°p kim c∆∞∆°ng</button>
            </form>
        </div>

        <!-- Modal -->
        <div id="bill-modal" style="display:none;" class="modal">
            <div class="modal-content">
                <h3>H√≥a ƒë∆°n thanh to√°n</h3>
                <p>ID game: <span id="bill-id"></span></p>
                <p>S·ªë kim c∆∞∆°ng: <span id="bill-amount"></span></p>
                <button onclick="confirmRecharge()">X√°c nh·∫≠n thanh to√°n</button>
            </div>
        </div>

        <!-- Th√¥ng b√°o -->
        <div id="success-message" style="display:none;">N·∫°p th√†nh c√¥ng!</div>
    </div>

    <!-- JavaScript x·ª≠ l√Ω n·∫°p kim c∆∞∆°ng -->
    <script>
        document.getElementById('recharge-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const gameId = document.getElementById('game-id').value;
            const amount = document.getElementById('diamond-amount').value;

            document.getElementById('bill-id').innerText = gameId;
            document.getElementById('bill-amount').innerText = amount;
            document.getElementById('bill-modal').style.display = 'block';
        });

        function confirmRecharge() {
            document.getElementById('bill-modal').style.display = 'none';
            document.getElementById('success-message').style.display = 'block';
        }
    </script>
    <script>
  const userDiamonds = {{ diamonds }}; // S·ªë kim c∆∞∆°ng hi·ªán c√≥ t·ª´ Flask

  document.getElementById('recharge-form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const gameId = document.getElementById('game-id').value;
    const amount = parseInt(document.getElementById('diamond-amount').value);

    if (amount < 100) {
      alert("S·ªë kim c∆∞∆°ng t·ªëi thi·ªÉu ƒë·ªÉ n·∫°p l√† 100.");
      return;
    }

    if (amount > userDiamonds) {
      alert("B·∫°n kh√¥ng ƒë·ªß kim c∆∞∆°ng ƒë·ªÉ n·∫°p.");
      return;
    }

    // Hi·ªÉn th·ªã h√≥a ƒë∆°n
    document.getElementById('bill-id').innerText = gameId;
    document.getElementById('bill-amount').innerText = amount;
    document.getElementById('bill-modal').style.display = 'block';
  });

  function confirmRecharge() {
    document.getElementById('bill-modal').style.display = 'none';
    document.getElementById('success-message').style.display = 'block';

    // Optional: g·ªçi API Flask ƒë·ªÉ tr·ª´ kim c∆∞∆°ng (b∆∞·ªõc 2)
  }
</script>
</body>
</html>
